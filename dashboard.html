<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modern Responsive Dashboard with To-Do List & Local Storage Editor</title>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    /* Reset and base */
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0; padding: 0; height: 100%;
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to bottom, #f3e9eb, #a97ebd, #4a1f4a);
      color: #1a1a2e;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    button {
      cursor: pointer;
      border: none;
      background: none;
      font: inherit;
    }
    button:focus, input:focus, textarea:focus {
      outline: 2px solid #3b2f6d;
      outline-offset: 2px;
    }
    /* Scrollbar */
    .scrollbar-thin {
      scrollbar-width: thin;
      scrollbar-color: rgba(59,47,109,0.3) transparent;
    }
    .scrollbar-thin::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    .scrollbar-thin::-webkit-scrollbar-track {
      background: transparent;
    }
    .scrollbar-thin::-webkit-scrollbar-thumb {
      background-color: rgba(59, 47, 109, 0.3);
      border-radius: 3px;
    }

    /* Layout */
    #sidebar {
      background: white;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      width: 16rem;
      min-width: 16rem;
      display: flex;
      flex-direction: column;
      border: 1px solid transparent;
      transition: background-color 0.3s ease;
      flex-shrink: 0;
    }
    #sidebar.dark {
      background: #1a1a2e;
      border-color: #3b2f6d;
      box-shadow: 0 0 20px rgba(59,47,109,0.5);
    }
    #sidebar .title {
      padding: 1.5rem 1.5rem;
      font-size: 1.5rem;
      font-weight: 600;
      user-select: none;
      color: #3b2f6d;
      transition: color 0.3s ease;
    }
    #sidebar.dark .title {
      color: #a97ebd;
    }
    #sidebar nav {
      margin-top: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      flex-grow: 1;
    }
    #sidebar button.nav-btn {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      font-size: 1rem;
      color: #3b2f6d;
      background: none;
      border-radius: 8px;
      transition: background-color 0.2s ease;
      user-select: none;
    }
    #sidebar button.nav-btn:hover {
      background: #e6e6e6;
    }
    #sidebar button.nav-btn.active {
      background: #e6e6e6;
    }
    #sidebar.dark button.nav-btn {
      color: #a97ebd;
    }
    #sidebar.dark button.nav-btn:hover {
      background: #4a1f4a;
    }
    #sidebar.dark button.nav-btn.active {
      background: #4a1f4a;
    }
    #sidebar .footer {
      padding: 1.5rem;
      font-size: 0.75rem;
      color: #6b6b6b;
      user-select: none;
      border-top: 1px solid #e6e6e6;
      transition: color 0.3s ease, border-color 0.3s ease;
    }
    #sidebar.dark .footer {
      color: #cbb9e0;
      border-color: #3b2f6d;
    }

    /* Logout button in sidebar */
    #logoutBtn {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      font-size: 1rem;
      color: #a97ebd;
      background: none;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s ease, color 0.2s ease;
      margin-top: auto;
      margin-bottom: 1.5rem;
    }
    #logoutBtn i {
      width: 20px;
      text-align: center;
      font-size: 1rem;
    }
    #logoutBtn:hover {
      background: #e6e6e6;
      color: #3b2f6d;
    }
    #sidebar.dark #logoutBtn {
      color: #d1c9e0;
    }
    #sidebar.dark #logoutBtn:hover {
      background: #4a1f4a;
      color: #a97ebd;
    }

    /* Main container */
    #main-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transition: background-color 0.3s ease;
      position: relative;
    }
    #main-container.dark {
      background: #1a1a2e;
      box-shadow: 0 0 20px rgba(59,47,109,0.5);
    }

    /* Top nav */
    header {
      height: 4rem;
      border-bottom: 1px solid #e6e6e6;
      padding: 0 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-radius: 20px 20px 0 0;
      transition: border-color 0.3s ease;
      background: white;
    }
    header.dark {
      border-color: #3b2f6d;
      background: #1a1a2e;
    }
    header h1 {
      font-weight: 600;
      font-size: 1.125rem;
      user-select: none;
      color: #1a1a2e;
      transition: color 0.3s ease;
    }
    header.dark h1 {
      color: #a97ebd;
    }
    .top-right {
      display: flex;
      align-items: center;
      gap: 1rem;
      color: #3b2f6d;
      transition: color 0.3s ease;
    }
    .top-right.dark {
      color: #a97ebd;
    }
    .icon-btn {
      padding: 0.5rem;
      border-radius: 9999px;
      transition: background-color 0.2s ease;
      color: inherit;
      font-size: 1.125rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .icon-btn:hover {
      background: #e6e6e6;
    }
    .icon-btn.dark:hover {
      background: #4a1f4a;
    }
    .icon-btn i.fa-sun {
      color: #facc15;
    }

    /* Profile dropdown */
    #profileDropdownWrapper {
      position: relative;
    }
    #profileBtn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border-radius: 9999px;
      background: none;
      border: none;
      color: inherit;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      user-select: none;
    }
    #userAvatar {
      width: 2rem;
      height: 2rem;
      border-radius: 9999px;
      background: #3b2f6d;
      color: white;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    #main-container.dark #userAvatar {
      background: #a97ebd;
    }
    #profileDropdown {
      position: absolute;
      right: 0;
      margin-top: 0.5rem;
      width: 12rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      padding: 0.25rem 0;
      z-index: 20;
      display: none;
      color: #3b2f6d;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    #profileDropdown.dark {
      background: #3b2f6d;
      color: white;
    }
    #profileDropdown a {
      display: block;
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      user-select: none;
      transition: background-color 0.2s ease;
      cursor: pointer;
    }
    #profileDropdown a:hover {
      background: #e6e6e6;
    }
    #profileDropdown.dark a:hover {
      background: #4a1f4a;
    }

    /* Content */
    main {
      flex-grow: 1;
      overflow-y: auto;
      padding: 1.5rem;
      background: white;
      border-radius: 0 0 20px 20px;
      display: flex;
      flex-direction: column;
      transition: background-color 0.3s ease;
      position: relative;
    }
    main.dark {
      background: #1a1a2e;
    }

    /* Dashboard view */
    #dashboardView h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #3b2f6d;
      user-select: none;
      margin: 0 0 1rem 0;
      transition: color 0.3s ease;
    }
    main.dark #dashboardView h2 {
      color: #a97ebd;
    }
    #dashboardView p {
      color: #6b6b6b;
      max-width: 42rem;
      user-select: text;
      margin: 0;
      transition: color 0.3s ease;
    }
    main.dark #dashboardView p {
      color: #cbb9e0;
    }

    /* Members view */
    #membersView {
      display: none;
      flex-direction: column;
      height: 100%;
    }
    #membersView.active {
      display: flex;
    }
    #membersView .header-row {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      margin-bottom: 1rem;
      gap: 1rem;
      flex-wrap: wrap;
    }
    #membersView h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #3b2f6d;
      user-select: none;
      margin: 0;
      transition: color 0.3s ease;
      flex-grow: 1;
      min-width: 150px;
    }
    main.dark #membersView h2 {
      color: #a97ebd;
    }
    #addTaskBtn {
      background: #3b2f6d;
      color: white;
      font-weight: 600;
      font-size: 0.875rem;
      border-radius: 9999px;
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: background-color 0.2s ease;
      user-select: none;
      border: none;
      cursor: pointer;
      white-space: nowrap;
    }
    #addTaskBtn:hover {
      background: #2a1f4a;
    }

    /* Delete Selected Button */
    #deleteSelectedBtn {
      background: #a97ebd;
      color: white;
      font-weight: 600;
      font-size: 0.875rem;
      border-radius: 9999px;
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: background-color 0.2s ease;
      user-select: none;
      border: none;
      cursor: pointer;
      visibility: hidden;
      opacity: 0;
      pointer-events: none;
      white-space: nowrap;
    }
    #deleteSelectedBtn.visible {
      visibility: visible;
      opacity: 1;
      pointer-events: auto;
    }
    #deleteSelectedBtn:hover {
      background: #7a5a9e;
    }
    #main-container.dark #deleteSelectedBtn {
      background: #7a5a9e;
      color: #d1c9e0;
    }
    #main-container.dark #deleteSelectedBtn:hover {
      background: #a97ebd;
      color: #3b2f6d;
    }

    /* Search input */
    #searchInput {
      width: 100%;
      max-width: 24rem;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      border: 1px solid #e6e6e6;
      background: white;
      color: #1a1a2e;
      font-size: 1rem;
      transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
      margin-bottom: 1rem;
    }
    #searchInput::placeholder {
      color: #a97ebd;
    }
    #searchInput:focus {
      border-color: #3b2f6d;
      outline: none;
      box-shadow: 0 0 0 2px #3b2f6d;
    }
    main.dark #searchInput {
      background: #3b2f6d;
      color: #e6e6e6;
      border-color: #a97ebd;
    }
    main.dark #searchInput::placeholder {
      color: #d1c9e0;
    }

    /* Table container */
    .table-container {
      flex-grow: 1;
      overflow-y: auto;
      border: 1px solid #e6e6e6;
      border-radius: 12px;
      box-sizing: border-box;
    }
    main.dark .table-container {
      border-color: #3b2f6d;
    }

    /* Table */
    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 0.875rem;
      color: #1a1a2e;
      transition: color 0.3s ease;
    }
    main.dark table {
      color: #d1c9e0;
    }
    thead {
      background: #f3e9eb;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    main.dark thead {
      background: #3b2f6d;
    }
    thead th {
      padding: 0.5rem 0.75rem;
      font-weight: 600;
      color: #3b2f6d;
      text-align: left;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      transition: color 0.3s ease;
    }
    main.dark thead th {
      color: #d1c9e0;
    }
    thead th:first-child {
      width: 2.5rem;
      cursor: default;
    }
    thead th:last-child {
      width: 6rem;
      cursor: default;
    }
    thead th i {
      margin-left: 0.25rem;
      color: #a97ebd;
      transition: color 0.3s ease;
    }
    main.dark thead th i {
      color: #d1c9e0;
    }
    tbody tr {
      transition: background-color 0.15s ease;
      cursor: default;
    }
    tbody tr:hover {
      background: #e6e6e6;
    }
    main.dark tbody tr:hover {
      background: #4a1f4a;
    }
    tbody td {
      padding: 0.5rem 0.75rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      vertical-align: middle;
      color: #1a1a2e;
      transition: color 0.3s ease;
    }
    main.dark tbody td {
      color: #d1c9e0;
    }
    tbody td:first-child {
      width: 2.5rem;
      text-align: center;
    }
    tbody td:last-child {
      width: 6rem;
      text-align: center;
    }
    tbody button {
      background: none;
      border: none;
      font-size: 1rem;
      color: #3b2f6d;
      margin: 0 0.25rem;
      transition: color 0.2s ease;
      cursor: pointer;
    }
    tbody button:hover {
      color: #2a1f4a;
    }
    main.dark tbody button {
      color: #d1c9e0;
    }
    main.dark tbody button:hover {
      color: #7a5a9e;
    }

    /* Checkbox */
    input[type="checkbox"] {
      width: 1rem;
      height: 1rem;
      cursor: pointer;
    }

    /* Modal overlay */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(74, 31, 74, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .modal-overlay.active {
      visibility: visible;
      opacity: 1;
    }

    /* Modal content */
    .modal-content {
      background: white;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      max-width: 28rem;
      width: 100%;
      padding: 1.5rem;
      position: relative;
      transition: background-color 0.3s ease;
    }
    .modal-content.dark {
      background: #3b2f6d;
      box-shadow: 0 0 20px rgba(59,47,109,0.7);
      color: #d1c9e0;
    }
    .modal-content h3 {
      margin: 0 0 1rem 0;
      font-size: 1.25rem;
      font-weight: 600;
      color: #1a1a2e;
      transition: color 0.3s ease;
    }
    .modal-content.dark h3 {
      color: #d1c9e0;
    }
    .modal-content label {
      display: block;
      font-weight: 600;
      font-size: 0.875rem;
      margin-bottom: 0.25rem;
      color: #3b2f6d;
      transition: color 0.3s ease;
    }
    .modal-content.dark label {
      color: #d1e0e0;
    }
    .modal-content input[type="text"],
    .modal-content input[type="email"],
    .modal-content input[type="time"],
    .modal-content input[type="date"],
    .modal-content textarea {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      border: 1px solid #e6e6e6;
      font-size: 1rem;
      color: #1a1a2e;
      background: white;
      transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
      font-family: 'Inter', sans-serif;
      resize: vertical;
    }
    .modal-content input[type="text"]:focus,
    .modal-content input[type="email"]:focus,
    .modal-content input[type="time"]:focus,
    .modal-content input[type="date"]:focus,
    .modal-content textarea:focus {
      border-color: #3b2f6d;
      outline: none;
      box-shadow: 0 0 0 2px #3b2f6d;
    }
    .modal-content.dark input[type="text"],
    .modal-content.dark input[type="email"],
    .modal-content.dark input[type="time"],
    .modal-content.dark input[type="date"],
    .modal-content.dark textarea {
      background: #4a1f4a;
      color: #d1c9e0;
      border-color: #a97ebd;
    }

    /* Modal buttons */
    .modal-buttons {
      margin-top: 1rem;
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
      border-top: 1px solid #e6e6e6;
      padding-top: 1rem;
      transition: border-color 0.3s ease;
    }
    .modal-buttons.dark {
      border-color: #a97ebd;
    }
    .btn-cancel, .btn-save {
      border-radius: 9999px;
      font-weight: 600;
      font-size: 1rem;
      padding: 0.5rem 1rem;
      user-select: none;
      transition: background-color 0.2s ease;
      border: none;
    }
    .btn-cancel {
      background: #e6e6e6;
      color: #3b2f6d;
    }
    .btn-cancel:hover {
      background: #d1c9e0;
    }
    .btn-save {
      background: #3b2f6d;
      color: white;
    }
    .btn-save:hover {
      background: #2a1f4a;
    }
    .modal-content.dark .btn-cancel {
      background: #7a5a9e;
      color: #d1c9e0;
    }
    .modal-content.dark .btn-cancel:hover {
      background: #a97ebd;
    }
    .modal-content.dark .btn-save {
      background: #a97ebd;
      color: #3b2f6d;
    }
    .modal-content.dark .btn-save:hover {
      background: #7a5a9e;
      color: #fff;
    }

    /* Readonly email display */
    .readonly-email {
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      background-color: #e6e6e6;
      color: #3b2f6d;
      font-size: 1rem;
      user-select: text;
      border: 1px solid #e6e6e6;
      margin-bottom: 1rem;
      word-break: break-word;
    }
    .modal-content.dark .readonly-email {
      background-color: #4a1f4a;
      color: #d1c9e0;
      border-color: #a97ebd;
    }

    /* Local Storage Panel */
    #localStorageView {
      background: white;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      margin-top: 1.5rem;
      padding: 1rem 1.5rem;
      max-height: 40vh;
      overflow-y: auto;
      transition: background-color 0.3s ease;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    #localStorageView.dark {
      background: #1a1a2e;
      box-shadow: 0 0 20px rgba(59,47,109,0.5);
      color: #d1c9e0;
    }
    #localStorageView h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #3b2f6d;
      user-select: none;
      transition: color 0.3s ease;
    }
    #localStorageView.dark h2 {
      color: #a97ebd;
    }
    #storageList {
      max-height: 25vh;
      overflow-y: auto;
      border: 1px solid #e6e6e6;
      border-radius: 12px;
      padding: 0.5rem;
      font-family: monospace, monospace;
      font-size: 0.875rem;
      background: #fafafa;
      color: #1a1a2e;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      flex-shrink: 0;
    }
    #localStorageView.dark #storageList {
      background: #3b2f6d;
      color: #d1c9e0;
      border-color: #a97ebd;
    }
    #storageList div {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.25rem 0.5rem;
      border-bottom: 1px solid #e6e6e6;
      transition: border-color 0.3s ease;
    }
    #localStorageView.dark #storageList div {
      border-color: #5a3f7a;
    }
    #storageList div:last-child {
      border-bottom: none;
    }
    #storageList .key {
      font-weight: 600;
      color: #3b2f6d;
      max-width: 40%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      user-select: text;
      transition: color 0.3s ease;
    }
    #localStorageView.dark #storageList .key {
      color: #a97ebd;
    }
    #storageList .value {
      max-width: 50%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      user-select: text;
      color: #6b6b6b;
      transition: color 0.3s ease;
    }
    #localStorageView.dark #storageList .value {
      color: #cbb9e0;
    }
    #storageList button.editStorageBtn {
      background: none;
      border: none;
      color: #3b2f6d;
      cursor: pointer;
      font-size: 0.9rem;
      padding: 0 0.25rem;
      transition: color 0.2s ease;
      flex-shrink: 0;
    }
    #storageList button.editStorageBtn:hover {
      color: #2a1f4a;
    }
    #localStorageView.dark #storageList button.editStorageBtn {
      color: #d1c9e0;
    }
    #localStorageView.dark #storageList button.editStorageBtn:hover {
      color: #7a5a9e;
    }

    #storageEditor {
      margin-top: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      flex-grow: 1;
      min-height: 0;
    }
    #storageEditor label {
      font-weight: 600;
      color: #3b2f6d;
      user-select: none;
      transition: color 0.3s ease;
    }
    #localStorageView.dark #storageEditor label {
      color: #a97ebd;
    }
    #storageEditor input[type="text"],
    #storageEditor textarea {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      border: 1px solid #e6e6e6;
      font-size: 0.875rem;
      font-family: monospace, monospace;
      resize: vertical;
      transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
      color: #1a1a2e;
      background: white;
      min-height: 3rem;
    }
    #storageEditor input[type="text"]:focus,
    #storageEditor textarea:focus {
      border-color: #3b2f6d;
      outline: none;
      box-shadow: 0 0 0 2px #3b2f6d;
    }
    #localStorageView.dark #storageEditor input[type="text"],
    #localStorageView.dark #storageEditor textarea {
      background: #4a1f4a;
      color: #d1c9e0;
      border-color: #a97ebd;
    }
    #storageEditor textarea {
      min-height: 6rem;
      flex-grow: 1;
      min-height: 6rem;
    }
    #storageEditor .buttons {
      display: flex;
      gap: 0.75rem;
      margin-top: 0.5rem;
      flex-wrap: wrap;
    }
    #storageEditor button {
      border-radius: 9999px;
      font-weight: 600;
      font-size: 0.875rem;
      padding: 0.5rem 1rem;
      user-select: none;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      white-space: nowrap;
      flex-shrink: 0;
    }
    #saveStorageBtn {
      background: #3b2f6d;
      color: white;
      flex-grow: 1;
      justify-content: center;
    }
    #saveStorageBtn:hover {
      background: #2a1f4a;
    }
    #deleteStorageBtn {
      background: #a97ebd;
      color: white;
      flex-grow: 1;
      justify-content: center;
    }
    #deleteStorageBtn:hover {
      background: #7a5a9e;
    }
    #clearStorageBtn {
      background: #6b6b6b;
      color: white;
      margin-left: auto;
      flex-grow: 1;
      justify-content: center;
    }
    #clearStorageBtn:hover {
      background: #4a4a4a;
    }
    #deleteStorageBtn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      #sidebar {
        width: 14rem;
        min-width: 14rem;
      }
    }

    @media (max-width: 768px) {
      body, html {
        flex-direction: column;
        height: 100%;
      }
      #sidebar {
        width: 100%;
        min-width: auto;
        border-radius: 0;
        box-shadow: none;
        border: none;
        flex-shrink: 0;
        flex-direction: row;
        overflow-x: auto;
        padding: 0.25rem 0;
        justify-content: center;
      }
      #sidebar .title {
        display: none;
      }
      #sidebar nav {
        flex-direction: row;
        gap: 0.5rem;
        margin-top: 0;
        width: 100%;
        justify-content: center;
      }
      #sidebar button.nav-btn {
        padding: 0.5rem 0.75rem;
        font-size: 0.875rem;
        border-radius: 12px;
        white-space: nowrap;
        flex-shrink: 0;
      }
      #sidebar button.nav-btn.active {
        background: #a97ebd;
        color: white;
      }
      #sidebar.dark button.nav-btn.active {
        background: #7a5a9e;
        color: #fff;
      }
      #sidebar .footer {
        display: none;
      }
      #logoutBtn {
        display: none;
      }
      #main-container {
        border-radius: 0;
        box-shadow: none;
        flex-grow: 1;
        overflow-y: auto;
      }
      header {
        border-radius: 0;
        height: 3.5rem;
        padding: 0 1rem;
      }
      header h1 {
        font-size: 1rem;
      }
      .top-right {
        gap: 0.5rem;
      }
      #membersView .header-row {
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      #membersView h2 {
        flex-grow: 1;
        min-width: auto;
        font-size: 1.25rem;
      }
      #addTaskBtn, #deleteSelectedBtn {
        font-size: 0.8rem;
        padding: 0.4rem 0.75rem;
      }
      #searchInput {
        max-width: 100%;
        margin-bottom: 0.75rem;
      }
      .table-container {
        border-radius: 8px;
      }
      table {
        font-size: 0.8rem;
      }
      thead th, tbody td {
        padding: 0.4rem 0.5rem;
      }
      thead th:first-child, tbody td:first-child {
        width: 2rem;
      }
      thead th:last-child, tbody td:last-child {
        width: 4rem;
      }

      /* Local Storage Panel adjustments */
      #localStorageView {
        margin-top: 0.75rem;
        border-radius: 0;
        padding: 1rem;
        max-height: none;
        flex-grow: 1;
      }
      #storageList {
        max-height: 20vh;
        font-size: 0.8rem;
      }
      #storageList div {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.25rem;
        padding: 0.25rem 0.25rem;
      }
      #storageList .key, #storageList .value {
        max-width: 100%;
        white-space: normal;
        overflow: visible;
        text-overflow: unset;
      }
      #storageList button.editStorageBtn {
        align-self: flex-end;
        padding: 0;
      }
      #storageEditor {
        margin-top: 0.75rem;
        gap: 0.25rem;
      }
      #storageEditor input[type="text"],
      #storageEditor textarea {
        font-size: 0.875rem;
        min-height: 2.5rem;
      }
      #storageEditor textarea {
        min-height: 5rem;
      }
      #storageEditor .buttons {
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      #storageEditor button {
        flex-grow: 1;
        font-size: 0.875rem;
        padding: 0.5rem 0;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <aside id="sidebar" aria-label="Sidebar navigation">
    <div class="title">Dashboard</div>
    <nav>
      <button id="nav-dashboard" class="nav-btn active" aria-current="page" aria-label="Dashboard navigation"> 
        <i class="fas fa-tachometer-alt" aria-hidden="true" style="width:20px;text-align:center;"></i> Dashboard
      </button>
      <button id="nav-members" class="nav-btn" aria-label="Members navigation">
        <i class="fas fa-users" aria-hidden="true" style="width:20px;text-align:center;"></i> Members
      </button>
      <button id="nav-localstorage" class="nav-btn" aria-label="Local Storage Editor navigation">
        <i class="fas fa-database" aria-hidden="true" style="width:20px;text-align:center;"></i> Local Storage
      </button>
      <button class="logout" id="logoutBtn" type="button" aria-label="Logout">
        <i class="fas fa-sign-out-alt" style="width:20px;"></i>
        <span>Logout</span>
      </button>
    </nav>
    <div class="footer">&copy; 2024 Your Company</div>
  </aside>

  <div id="main-container" role="main" aria-live="polite">
    <header>
      <h1 id="greeting">Welcome, User</h1>
      <div class="top-right">
        <button id="darkModeToggle" class="icon-btn" aria-label="Toggle dark mode" title="Toggle dark mode">
          <i class="fas fa-moon" aria-hidden="true"></i>
          <i class="fas fa-sun" aria-hidden="true" style="display:none; color:#facc15;"></i>
        </button>
        <div id="profileDropdownWrapper">
          <button id="profileBtn" aria-haspopup="true" aria-expanded="false" aria-label="User profile menu">
            <div id="userAvatar" aria-hidden="true">JD</div>
            <i class="fas fa-chevron-down" aria-hidden="true"></i>
          </button>
          <div id="profileDropdown" role="menu" aria-orientation="vertical" aria-labelledby="profileBtn">
            <a href="#" role="menuitem" tabindex="-1" id="profileLogout">Logout</a>
          </div>
        </div>
      </div>
    </header>

    <main>
      <section id="dashboardView" aria-label="Dashboard Home View">
        <h2>Dashboard</h2>
        <p>This is your dashboard home. Use the sidebar to navigate to the Members section to manage your to-do list or to the Local Storage section to view and edit local storage.</p>
      </section>

      <section id="membersView" aria-label="Members To-Do List" tabindex="0" style="display:none; flex-direction: column; height: 100%;">
        <div class="header-row" style="display:flex; align-items:center; justify-content:flex-start; margin-bottom:1rem; gap: 1rem;">
          <h2>Members - To-Do List</h2>
          <button id="addTaskBtn" aria-label="Add new task" style="margin-left:1rem;">
            <i class="fas fa-plus" aria-hidden="true"></i> Add Task
          </button>
          <button id="deleteSelectedBtn" aria-label="Delete selected tasks" title="Delete selected tasks" style="margin-left:1rem;">
            <i class="fas fa-trash-alt" aria-hidden="true"></i> Delete Selected
          </button>
        </div>
        <input id="searchInput" type="search" placeholder="Search tasks, user emails..." aria-label="Search tasks" />
        <div class="table-container scrollbar-thin" tabindex="0" aria-live="polite" aria-relevant="additions removals">
          <table role="grid" aria-describedby="taskTableDesc" aria-label="To-Do List Tasks">
            <caption id="taskTableDesc" class="sr-only">List of tasks with user email, login time, deadline, and actions</caption>
            <thead>
              <tr>
                <th scope="col"><input type="checkbox" id="selectAllCheckbox" aria-label="Select all tasks" /></th>
                <th scope="col" tabindex="0" role="button" aria-pressed="false" data-sort-key="taskName" aria-label="Sort by Task Name">Task Name <i class="fas fa-sort"></i></th>
                <th scope="col" tabindex="0" role="button" aria-pressed="false" data-sort-key="userEmail" aria-label="Sort by User Email">User Email <i class="fas fa-sort"></i></th>
                <th scope="col" tabindex="0" role="button" aria-pressed="false" data-sort-key="loginTime" aria-label="Sort by Login Time">Login Time <i class="fas fa-sort"></i></th>
                <th scope="col" tabindex="0" role="button" aria-pressed="false" data-sort-key="deadline" aria-label="Sort by Deadline">Deadline <i class="fas fa-sort"></i></th>
                <th scope="col">Actions</th>
              </tr>
            </thead>
            <tbody id="taskTableBody"></tbody>
          </table>
        </div>
      </section>

      <section id="localStorageView" aria-label="Local Storage Editor" tabindex="0" style="display:none; flex-direction: column; height: 100%;">
        <h2>Local Storage Editor</h2>
        <div id="storageList" aria-live="polite" aria-relevant="additions removals" tabindex="0" role="list"></div>
        <form id="storageEditor" aria-label="Local Storage Editor Form" novalidate>
          <label for="storageKeyInput">Key</label>
          <input type="text" id="storageKeyInput" name="storageKey" placeholder="Enter key" required autocomplete="off" />
          <label for="storageValueInput">Value (JSON or plain text)</label>
          <textarea id="storageValueInput" name="storageValue" placeholder="Enter value" required></textarea>
          <div class="buttons">
            <button type="submit" id="saveStorageBtn" aria-label="Save local storage item">
              <i class="fas fa-save" aria-hidden="true"></i> Save
            </button>
            <button type="button" id="deleteStorageBtn" aria-label="Delete local storage item" disabled>
              <i class="fas fa-trash-alt" aria-hidden="true"></i> Delete
            </button>
            <button type="button" id="clearStorageBtn" aria-label="Clear all local storage items">
              <i class="fas fa-broom" aria-hidden="true"></i> Clear All
            </button>
          </div>
        </form>
      </section>
    </main>
  </div>

  <!-- Edit Modal -->
  <div id="editModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="editModalTitle" tabindex="-1">
    <div class="modal-content" role="document">
      <h3 id="editModalTitle">Edit Task</h3>
      <form id="editForm" novalidate>
        <label for="editTaskName">Task Name</label>
        <input type="text" id="editTaskName" name="taskName" required />
        <label>User Email</label>
        <div id="editUserEmailDisplay" class="readonly-email" aria-live="polite" aria-atomic="true"></div>
        <label for="editLoginTime">Login Time</label>
        <input type="time" id="editLoginTime" name="loginTime" required />
        <label for="editDeadline">Deadline</label>
        <input type="date" id="editDeadline" name="deadline" required />
        <div class="modal-buttons">
          <button type="button" id="cancelEditBtn" class="btn-cancel">Cancel</button>
          <button type="submit" class="btn-save">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Task Modal -->
  <div id="addTaskModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="addTaskModalTitle" tabindex="-1">
    <div class="modal-content" role="document">
      <h3 id="addTaskModalTitle">Add New Task</h3>
      <form id="addTaskForm" novalidate>
        <label for="addTaskName">Task Name</label>
        <input type="text" id="addTaskName" name="taskName" placeholder="Enter task name" required />
        <label>User Email</label>
        <div id="addUserEmailDisplay" class="readonly-email" aria-live="polite" aria-atomic="true"></div>
        <label for="addLoginTime">Login Time</label>
        <input type="time" id="addLoginTime" name="loginTime" required />
        <label for="addDeadline">Deadline</label>
        <input type="date" id="addDeadline" name="deadline" required />
        <div class="modal-buttons">
          <button type="button" id="cancelAddBtn" class="btn-cancel">Cancel</button>
          <button type="submit" class="btn-save">Add</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    (() => {
      // Elements
      const navDashboardBtn = document.getElementById("nav-dashboard");
      const navMembersBtn = document.getElementById("nav-members");
      const navLocalStorageBtn = document.getElementById("nav-localstorage");
      const dashboardView = document.getElementById("dashboardView");
      const membersView = document.getElementById("membersView");
      const localStorageView = document.getElementById("localStorageView");
      const greetingEl = document.getElementById("greeting");
      const darkModeToggle = document.getElementById("darkModeToggle");
      const bodyEl = document.body;
      const mainContainer = document.getElementById("main-container");
      const sidebar = document.getElementById("sidebar");
      const profileBtn = document.getElementById("profileBtn");
      const profileDropdown = document.getElementById("profileDropdown");
      const profileDropdownWrapper = document.getElementById("profileDropdownWrapper");
      const userAvatar = document.getElementById("userAvatar");
      const logoutBtn = document.getElementById("logoutBtn");
      const profileLogoutLink = document.getElementById("profileLogout");

      // To-Do List Elements
      const taskTableBody = document.getElementById("taskTableBody");
      const selectAllCheckbox = document.getElementById("selectAllCheckbox");
      const searchInput = document.getElementById("searchInput");
      const addTaskBtn = document.getElementById("addTaskBtn");
      const deleteSelectedBtn = document.getElementById("deleteSelectedBtn");

      // Edit Modal Elements
      const editModal = document.getElementById("editModal");
      const editForm = document.getElementById("editForm");
      const cancelEditBtn = document.getElementById("cancelEditBtn");
      const editTaskNameInput = document.getElementById("editTaskName");
      const editUserEmailDisplay = document.getElementById("editUserEmailDisplay");
      const editLoginTimeInput = document.getElementById("editLoginTime");
      const editDeadlineInput = document.getElementById("editDeadline");

      // Add Modal Elements
      const addTaskModal = document.getElementById("addTaskModal");
      const addTaskForm = document.getElementById("addTaskForm");
      const cancelAddBtn = document.getElementById("cancelAddBtn");
      const addTaskNameInput = document.getElementById("addTaskName");
      const addUserEmailDisplay = document.getElementById("addUserEmailDisplay");
      const addLoginTimeInput = document.getElementById("addLoginTime");
      const addDeadlineInput = document.getElementById("addDeadline");

      // Local Storage Elements
      const storageList = document.getElementById("storageList");
      const storageKeyInput = document.getElementById("storageKeyInput");
      const storageValueInput = document.getElementById("storageValueInput");
      const saveStorageBtn = document.getElementById("saveStorageBtn");
      const deleteStorageBtn = document.getElementById("deleteStorageBtn");
      const clearStorageBtn = document.getElementById("clearStorageBtn");

      // State
      let currentUserName = "John Doe";
      let currentUserEmail = "john.doe";
      let tasks = [];
      let filteredTasks = [];
      let currentSort = { key: null, asc: true };
      let editingTaskId = null;

      // Local Storage editing state
      let editingStorageKey = null;

      // Utility: Generate initials from name
      function getInitials(name) {
        const parts = name.trim().split(" ");
        if (parts.length === 1) return parts[0].charAt(0).toUpperCase();
        return (
          parts[0].charAt(0).toUpperCase() + parts[parts.length - 1].charAt(0).toUpperCase()
        );
      }

      // Load data from localStorage
      function loadData() {
        const savedTasks = localStorage.getItem("todoTasks");
        if (savedTasks) {
          try {
            tasks = JSON.parse(savedTasks);
          } catch {
            tasks = [];
          }
        } else {
          // Sample initial data
          tasks = [
            {
              id: crypto.randomUUID(),
              taskName: "Finish project report",
              userEmail: "alice",
              loginTime: "09:30",
              deadline: "2024-06-15",
              selected: false,
            },
            {
              id: crypto.randomUUID(),
              taskName: "Update website content",
              userEmail: "bob",
              loginTime: "10:15",
              deadline: "2024-06-20",
              selected: false,
            },
            {
              id: crypto.randomUUID(),
              taskName: "Prepare presentation slides",
              userEmail: "carol",
              loginTime: "08:45",
              deadline: "2024-06-18",
              selected: false,
            },
            {
              id: crypto.randomUUID(),
              taskName: "Schedule team meeting",
              userEmail: "dave",
              loginTime: "11:00",
              deadline: "2024-06-22",
              selected: false,
            },
            {
              id: crypto.randomUUID(),
              taskName: "Review budget proposal",
              userEmail: "eve",
              loginTime: "09:00",
              deadline: "2024-06-19",
              selected: false,
            },
          ];
          saveData();
        }
      }

      // Save data to localStorage
      function saveData() {
        localStorage.setItem("todoTasks", JSON.stringify(tasks));
      }

      // Load dark mode preference
      function loadDarkMode() {
        const darkPref = localStorage.getItem("darkMode");
        if (darkPref === "true") {
          bodyEl.classList.add("dark");
          mainContainer.classList.add("dark");
          sidebar.classList.add("dark");
          document.querySelector("header").classList.add("dark");
          profileDropdown.classList.add("dark");
          editModal.querySelector(".modal-content").classList.add("dark");
          addTaskModal.querySelector(".modal-content").classList.add("dark");
          localStorageView.classList.add("dark");
          darkModeToggle.querySelector(".fa-moon").style.display = "none";
          darkModeToggle.querySelector(".fa-sun").style.display = "inline-block";
        } else {
          bodyEl.classList.remove("dark");
          mainContainer.classList.remove("dark");
          sidebar.classList.remove("dark");
          document.querySelector("header").classList.remove("dark");
          profileDropdown.classList.remove("dark");
          editModal.querySelector(".modal-content").classList.remove("dark");
          addTaskModal.querySelector(".modal-content").classList.remove("dark");
          localStorageView.classList.remove("dark");
          darkModeToggle.querySelector(".fa-moon").style.display = "inline-block";
          darkModeToggle.querySelector(".fa-sun").style.display = "none";
        }
      }

      // Save dark mode preference
      function saveDarkMode(enabled) {
        localStorage.setItem("darkMode", enabled ? "true" : "false");
      }

      // Render user avatar initials
      function renderUserAvatar() {
        userAvatar.textContent = getInitials(currentUserName);
      }

      // Render greeting
      function renderGreeting() {
        greetingEl.textContent = `Welcome, ${currentUserName}`;
      }

      // Render tasks table rows
      function renderTasks() {
        // Filter tasks by search
        const searchTerm = searchInput.value.trim().toLowerCase();
        filteredTasks = tasks.filter((task) => {
          return (
            task.taskName.toLowerCase().includes(searchTerm) ||
            task.userEmail.toLowerCase().includes(searchTerm) ||
            task.loginTime.toLowerCase().includes(searchTerm) ||
            task.deadline.toLowerCase().includes(searchTerm)
          );
        });

        // Sort tasks if sorting is active
        if (currentSort.key) {
          filteredTasks.sort((a, b) => {
            let valA = a[currentSort.key];
            let valB = b[currentSort.key];
            if (valA < valB) return currentSort.asc ? -1 : 1;
            if (valA > valB) return currentSort.asc ? 1 : -1;
            return 0;
          });
        }

        // Clear table body
        taskTableBody.innerHTML = "";

        if (filteredTasks.length === 0) {
          const tr = document.createElement("tr");
          const td = document.createElement("td");
          td.colSpan = 6;
          td.style.textAlign = "center";
          td.style.padding = "1.5rem 0";
          td.style.color = "#a97ebd";
          td.style.userSelect = "none";
          td.textContent = "No tasks found.";
          tr.appendChild(td);
          taskTableBody.appendChild(tr);
          updateDeleteSelectedBtn();
          return;
        }

        filteredTasks.forEach((task) => {
          const tr = document.createElement("tr");
          tr.style.transition = "background-color 0.15s ease";
          tr.style.cursor = "default";
          tr.addEventListener("mouseenter", () => {
            tr.style.backgroundColor = bodyEl.classList.contains("dark") ? "#4a1f4a" : "#e6e6e6";
          });
          tr.addEventListener("mouseleave", () => {
            tr.style.backgroundColor = "";
          });

          // Checkbox cell
          const tdCheckbox = document.createElement("td");
          tdCheckbox.style.padding = "0.5rem 0.75rem";
          tdCheckbox.style.textAlign = "center";
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = task.selected || false;
          checkbox.setAttribute("aria-label", `Select task ${task.taskName}`);
          checkbox.style.cursor = "pointer";
          checkbox.style.width = "1rem";
          checkbox.style.height = "1rem";
          checkbox.addEventListener("change", () => {
            task.selected = checkbox.checked;
            updateSelectAllCheckbox();
            updateDeleteSelectedBtn();
            saveData();
          });
          tdCheckbox.appendChild(checkbox);
          tr.appendChild(tdCheckbox);

          // Task Name
          const tdTaskName = document.createElement("td");
          tdTaskName.style.padding = "0.5rem 0.75rem";
          tdTaskName.style.fontSize = "0.875rem";
          tdTaskName.style.whiteSpace = "nowrap";
          tdTaskName.style.overflow = "hidden";
          tdTaskName.style.textOverflow = "ellipsis";
          tdTaskName.style.maxWidth = "12rem";
          tdTaskName.textContent = task.taskName;
          tr.appendChild(tdTaskName);

          // User Email
          const tdUserEmail = document.createElement("td");
          tdUserEmail.style.padding = "0.5rem 0.75rem";
          tdUserEmail.style.fontSize = "0.875rem";
          tdUserEmail.style.whiteSpace = "nowrap";
          tdUserEmail.style.overflow = "hidden";
          tdUserEmail.style.textOverflow = "ellipsis";
          tdUserEmail.style.maxWidth = "14rem";
          tdUserEmail.textContent = task.userEmail;
          tr.appendChild(tdUserEmail);

          // Login Time
          const tdLoginTime = document.createElement("td");
          tdLoginTime.style.padding = "0.5rem 0.75rem";
          tdLoginTime.style.fontSize = "0.875rem";
          tdLoginTime.textContent = task.loginTime;
          tr.appendChild(tdLoginTime);

          // Deadline
          const tdDeadline = document.createElement("td");
          tdDeadline.style.padding = "0.5rem 0.75rem";
          tdDeadline.style.fontSize = "0.875rem";
          tdDeadline.textContent = task.deadline;
          tr.appendChild(tdDeadline);

          // Actions
          const tdActions = document.createElement("td");
          tdActions.style.padding = "0.5rem 0.75rem";
          tdActions.style.fontSize = "0.875rem";
          tdActions.style.textAlign = "center";

          // Edit button
          const editBtn = document.createElement("button");
          editBtn.style.color = "#3b2f6d";
          editBtn.style.margin = "0 0.25rem";
          editBtn.title = `Edit task ${task.taskName}`;
          editBtn.innerHTML = '<i class="fas fa-edit"></i>';
          editBtn.addEventListener("mouseenter", () => {
            editBtn.style.color = "#2a1f4a";
          });
          editBtn.addEventListener("mouseleave", () => {
            editBtn.style.color = bodyEl.classList.contains("dark") ? "#d1e0e0" : "#3b2f6d";
          });
          editBtn.addEventListener("click", () => openEditModal(task.id));
          tdActions.appendChild(editBtn);

          // Delete button
          const deleteBtn = document.createElement("button");
          deleteBtn.style.color = "#a97ebd";
          deleteBtn.style.margin = "0 0.25rem";
          deleteBtn.title = `Delete task ${task.taskName}`;
          deleteBtn.innerHTML = '<i class="fas fa-trash-alt"></i>';
          deleteBtn.addEventListener("mouseenter", () => {
            deleteBtn.style.color = "#7a5a9e";
          });
          deleteBtn.addEventListener("mouseleave", () => {
            deleteBtn.style.color = bodyEl.classList.contains("dark") ? "#d1e0e0" : "#a97ebd";
          });
          deleteBtn.addEventListener("click", () => deleteTask(task.id));
          tdActions.appendChild(deleteBtn);

          tr.appendChild(tdActions);

          taskTableBody.appendChild(tr);
        });
        updateDeleteSelectedBtn();
      }

      // Update select all checkbox state
      function updateSelectAllCheckbox() {
        if (tasks.length === 0) {
          selectAllCheckbox.checked = false;
          selectAllCheckbox.indeterminate = false;
          return;
        }
        const selectedCount = tasks.filter((t) => t.selected).length;
        if (selectedCount === 0) {
          selectAllCheckbox.checked = false;
          selectAllCheckbox.indeterminate = false;
        } else if (selectedCount === tasks.length) {
          selectAllCheckbox.checked = true;
          selectAllCheckbox.indeterminate = false;
        } else {
          selectAllCheckbox.checked = false;
          selectAllCheckbox.indeterminate = true;
        }
      }

      // Select or deselect all tasks
      function toggleSelectAll(checked) {
        tasks.forEach((task) => {
          task.selected = checked;
        });
        saveData();
        renderTasks();
      }

      // Update Delete Selected button visibility
      function updateDeleteSelectedBtn() {
        const selectedCount = tasks.filter(t => t.selected).length;
        if (selectedCount > 0) {
          deleteSelectedBtn.classList.add("visible");
          deleteSelectedBtn.setAttribute("aria-label", `Delete ${selectedCount} selected tasks`);
        } else {
          deleteSelectedBtn.classList.remove("visible");
          deleteSelectedBtn.removeAttribute("aria-label");
        }
      }

      // Delete task by id
      function deleteTask(id) {
        if (!confirm("Are you sure you want to delete this task?")) return;
        tasks = tasks.filter((task) => task.id !== id);
        saveData();
        renderTasks();
        updateSelectAllCheckbox();
      }

      // Delete all selected tasks
      function deleteSelectedTasks() {
        if (!confirm("Are you sure you want to delete all selected tasks?")) return;
        tasks = tasks.filter(task => !task.selected);
        saveData();
        renderTasks();
        updateSelectAllCheckbox();
      }

      // Open edit modal with task data
      function openEditModal(id) {
        editingTaskId = id;
        const task = tasks.find((t) => t.id === id);
        if (!task) return;
        editTaskNameInput.value = task.taskName;
        editUserEmailDisplay.textContent = task.userEmail;
        editLoginTimeInput.value = task.loginTime;
        editDeadlineInput.value = task.deadline;
        showModal(editModal);
        editTaskNameInput.focus();
      }

      // Close edit modal
      function closeEditModal() {
        editingTaskId = null;
        hideModal(editModal);
        editForm.reset();
      }

      // Save edited task
      function saveEditedTask(e) {
        e.preventDefault();
        if (!editingTaskId) return;
        const task = tasks.find((t) => t.id === editingTaskId);
        if (!task) return;
        task.taskName = editTaskNameInput.value.trim();
        // userEmail remains unchanged
        task.loginTime = editLoginTimeInput.value;
        task.deadline = editDeadlineInput.value;
        saveData();
        renderTasks();
        updateSelectAllCheckbox();
        closeEditModal();
      }

      // Open add task modal
      function openAddTaskModal() {
        showModal(addTaskModal);
        addTaskForm.reset();
        addUserEmailDisplay.textContent = currentUserEmail;
        addTaskNameInput.focus();
      }

      // Close add task modal
      function closeAddTaskModal() {
        hideModal(addTaskModal);
        addTaskForm.reset();
      }

      // Save new task
      function saveNewTask(e) {
        e.preventDefault();
        const newTaskName = addTaskNameInput.value.trim();
        const newLoginTime = addLoginTimeInput.value;
        const newDeadline = addDeadlineInput.value;
        if (!newTaskName || !newLoginTime || !newDeadline) return;

        const newTask = {
          id: crypto.randomUUID(),
          taskName: newTaskName,
          userEmail: currentUserEmail,
          loginTime: newLoginTime,
          deadline: newDeadline,
          selected: false,
        };
        tasks.push(newTask);
        saveData();
        renderTasks();
        updateSelectAllCheckbox();
        closeAddTaskModal();
      }

      // Show modal
      function showModal(modal) {
        modal.classList.add("active");
        modal.setAttribute("aria-hidden", "false");
        modal.focus();
      }
      // Hide modal
      function hideModal(modal) {
        modal.classList.remove("active");
        modal.setAttribute("aria-hidden", "true");
      }

      // Switch views
      function switchView(view) {
        if (view === "dashboard") {
          dashboardView.style.display = "block";
          membersView.style.display = "none";
          localStorageView.style.display = "none";
          navDashboardBtn.classList.add("active");
          navDashboardBtn.setAttribute("aria-current", "page");
          navMembersBtn.classList.remove("active");
          navMembersBtn.removeAttribute("aria-current");
          navLocalStorageBtn.classList.remove("active");
          navLocalStorageBtn.removeAttribute("aria-current");
        } else if (view === "members") {
          dashboardView.style.display = "none";
          membersView.style.display = "flex";
          localStorageView.style.display = "none";
          navMembersBtn.classList.add("active");
          navMembersBtn.setAttribute("aria-current", "page");
          navDashboardBtn.classList.remove("active");
          navDashboardBtn.removeAttribute("aria-current");
          navLocalStorageBtn.classList.remove("active");
          navLocalStorageBtn.removeAttribute("aria-current");
          renderTasks();
          updateSelectAllCheckbox();
        } else if (view === "localstorage") {
          dashboardView.style.display = "none";
          membersView.style.display = "none";
          localStorageView.style.display = "flex";
          navLocalStorageBtn.classList.add("active");
          navLocalStorageBtn.setAttribute("aria-current", "page");
          navDashboardBtn.classList.remove("active");
          navDashboardBtn.removeAttribute("aria-current");
          navMembersBtn.classList.remove("active");
          navMembersBtn.removeAttribute("aria-current");
          loadLocalStorageItems();
          resetStorageEditor();
        }
      }

      // Sort tasks by key
      function sortTasksBy(key) {
        if (currentSort.key === key) {
          currentSort.asc = !currentSort.asc;
        } else {
          currentSort.key = key;
          currentSort.asc = true;
        }
        renderTasks();
        updateSortIcons();
      }

      // Update sort icons in headers
      function updateSortIcons() {
        const headers = document.querySelectorAll("thead th[data-sort-key]");
        headers.forEach((th) => {
          const icon = th.querySelector("i");
          if (!icon) return;
          const key = th.getAttribute("data-sort-key");
          if (key === currentSort.key) {
            icon.classList.remove("fa-sort");
            icon.classList.add(currentSort.asc ? "fa-sort-up" : "fa-sort-down");
            icon.style.color = "#3b2f6d";
          } else {
            icon.classList.remove("fa-sort-up", "fa-sort-down");
            icon.classList.add("fa-sort");
            icon.style.color = "#a97ebd";
          }
        });
      }

      // Toggle dark mode
      function toggleDarkMode() {
        const isDark = bodyEl.classList.toggle("dark");
        mainContainer.classList.toggle("dark", isDark);
        sidebar.classList.toggle("dark", isDark);
        document.querySelector("header").classList.toggle("dark", isDark);
        profileDropdown.classList.toggle("dark", isDark);
        editModal.querySelector(".modal-content").classList.toggle("dark", isDark);
        addTaskModal.querySelector(".modal-content").classList.toggle("dark", isDark);
        localStorageView.classList.toggle("dark", isDark);
        if (isDark) {
          darkModeToggle.querySelector(".fa-moon").style.display = "none";
          darkModeToggle.querySelector(".fa-sun").style.display = "inline-block";
        } else {
          darkModeToggle.querySelector(".fa-moon").style.display = "inline-block";
          darkModeToggle.querySelector(".fa-sun").style.display = "none";
        }
        saveDarkMode(isDark);
      }

      // Profile dropdown toggle
      function toggleProfileDropdown() {
        const expanded = profileBtn.getAttribute("aria-expanded") === "true";
        if (expanded) {
          profileDropdown.style.display = "none";
          profileBtn.setAttribute("aria-expanded", "false");
        } else {
          profileDropdown.style.display = "block";
          profileBtn.setAttribute("aria-expanded", "true");
        }
      }

      // Close profile dropdown if clicked outside
      function closeProfileDropdownOnClickOutside(e) {
        if (
          !profileDropdownWrapper.contains(e.target) &&
          profileBtn.getAttribute("aria-expanded") === "true"
        ) {
          profileDropdown.style.display = "none";
          profileBtn.setAttribute("aria-expanded", "false");
        }
      }

      // Logout button handler per spec
      function handleLogout() {
        localStorage.removeItem("status");
        localStorage.removeItem("user");
        localStorage.removeItem("userEmail");
        window.location.href = "index.html"; // Redirect to login page
      }

      // Local Storage Editor Functions

      // Load all localStorage items and render list
      function loadLocalStorageItems() {
        storageList.innerHTML = "";
        if (localStorage.length === 0) {
          const emptyDiv = document.createElement("div");
          emptyDiv.textContent = "Local storage is empty.";
          emptyDiv.style.textAlign = "center";
          emptyDiv.style.padding = "1rem";
          emptyDiv.style.color = "#a97ebd";
          emptyDiv.style.userSelect = "none";
          storageList.appendChild(emptyDiv);
          deleteStorageBtn.disabled = true;
          return;
        }
        // Exclude keys used by app for tasks and dark mode and user info
        const excludeKeys = new Set(["todoTasks", "darkMode", "status", "user", "userEmail"]);
        const keys = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (!excludeKeys.has(key)) keys.push(key);
        }
        if (keys.length === 0) {
          const emptyDiv = document.createElement("div");
          emptyDiv.textContent = "No editable local storage items found.";
          emptyDiv.style.textAlign = "center";
          emptyDiv.style.padding = "1rem";
          emptyDiv.style.color = "#a97ebd";
          emptyDiv.style.userSelect = "none";
          storageList.appendChild(emptyDiv);
          deleteStorageBtn.disabled = true;
          return;
        }
        keys.sort((a,b) => a.localeCompare(b));
        keys.forEach((key) => {
          const value = localStorage.getItem(key);
          const itemDiv = document.createElement("div");
          itemDiv.setAttribute("role", "listitem");
          itemDiv.tabIndex = 0;

          const keySpan = document.createElement("span");
          keySpan.className = "key";
          keySpan.title = key;
          keySpan.textContent = key;

          const valueSpan = document.createElement("span");
          valueSpan.className = "value";
          let displayValue = value;
          try {
            const parsed = JSON.parse(value);
            displayValue = JSON.stringify(parsed);
          } catch {}
          valueSpan.title = displayValue;
          valueSpan.textContent = displayValue.length > 50 ? displayValue.slice(0, 47) + "..." : displayValue;

          const editBtn = document.createElement("button");
          editBtn.className = "editStorageBtn";
          editBtn.setAttribute("aria-label", `Edit local storage item with key ${key}`);
          editBtn.innerHTML = '<i class="fas fa-pen"></i>';
          editBtn.addEventListener("click", () => {
            storageKeyInput.value = key;
            storageValueInput.value = value;
            editingStorageKey = key;
            deleteStorageBtn.disabled = false;
            storageKeyInput.focus();
          });

          itemDiv.appendChild(keySpan);
          itemDiv.appendChild(valueSpan);
          itemDiv.appendChild(editBtn);

          storageList.appendChild(itemDiv);
        });
        deleteStorageBtn.disabled = true;
      }

      // Reset storage editor inputs and state
      function resetStorageEditor() {
        storageKeyInput.value = "";
        storageValueInput.value = "";
        editingStorageKey = null;
        deleteStorageBtn.disabled = true;
      }

      // Save or update localStorage item
      function saveStorageItem(e) {
        e.preventDefault();
        const key = storageKeyInput.value.trim();
        let value = storageValueInput.value;

        if (!key) {
          alert("Key cannot be empty.");
          storageKeyInput.focus();
          return;
        }

        // Prevent overwriting app keys
        const reservedKeys = new Set(["todoTasks", "darkMode", "status", "user", "userEmail"]);
        if (reservedKeys.has(key)) {
          alert(`The key "${key}" is reserved and cannot be edited here.`);
          storageKeyInput.focus();
          return;
        }

        // Try to parse JSON to validate, but store as string anyway
        try {
          JSON.parse(value);
        } catch {
          // Not JSON, store as plain string
        }

        localStorage.setItem(key, value);
        loadLocalStorageItems();
        resetStorageEditor();
      }

      // Delete current localStorage key
      function deleteStorageItem() {
        if (!editingStorageKey) return;
        if (confirm(`Are you sure you want to delete the key "${editingStorageKey}"?`)) {
          localStorage.removeItem(editingStorageKey);
          loadLocalStorageItems();
          resetStorageEditor();
        }
      }

      // Clear all localStorage except app keys
      function clearAllLocalStorage() {
        if (localStorage.length === 0) return;
        if (confirm("Are you sure you want to clear all local storage except app data? This action cannot be undone.")) {
          const keysToKeep = new Set(["todoTasks", "darkMode", "status", "user", "userEmail"]);
          const keysToRemove = [];
          for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (!keysToKeep.has(key)) keysToRemove.push(key);
          }
          keysToRemove.forEach(k => localStorage.removeItem(k));
          loadLocalStorageItems();
          resetStorageEditor();
        }
      }

      // Initialization
      function init() {
        // Check login status per spec
        if (localStorage.getItem("status") !== "loggedIn") {
          window.location.href = "index.html";
          return;
        }

        // Display username and email from localStorage if available
        const username = localStorage.getItem("user") || "User";
        currentUserName = username;
        // For demo, use username only (no domain)
        currentUserEmail = localStorage.getItem("userEmail") || username.toLowerCase().replace(/\s+/g, ".");
        renderGreeting();
        renderUserAvatar();

        // Load data and dark mode
        loadData();
        loadDarkMode();

        // Initial view
        switchView("dashboard");

        // Event listeners
        navDashboardBtn.addEventListener("click", () => switchView("dashboard"));
        navMembersBtn.addEventListener("click", () => switchView("members"));
        navLocalStorageBtn.addEventListener("click", () => switchView("localstorage"));

        darkModeToggle.addEventListener("click", toggleDarkMode);

        profileBtn.addEventListener("click", toggleProfileDropdown);
        document.addEventListener("click", closeProfileDropdownOnClickOutside);

        // Link logout in profile dropdown to logout function
        profileLogoutLink.addEventListener("click", (e) => {
          e.preventDefault();
          handleLogout();
        });

        selectAllCheckbox.addEventListener("change", (e) =>
          toggleSelectAll(e.target.checked)
        );

        searchInput.addEventListener("input", () => {
          renderTasks();
          updateSelectAllCheckbox();
        });

        editForm.addEventListener("submit", saveEditedTask);
        cancelEditBtn.addEventListener("click", closeEditModal);

        addTaskBtn.addEventListener("click", openAddTaskModal);
        cancelAddBtn.addEventListener("click", closeAddTaskModal);
        addTaskForm.addEventListener("submit", saveNewTask);

        deleteSelectedBtn.addEventListener("click", deleteSelectedTasks);

        logoutBtn.addEventListener("click", handleLogout);

        // Sort headers click and keyboard
        const sortableHeaders = document.querySelectorAll("thead th[data-sort-key]");
        sortableHeaders.forEach((th) => {
          th.addEventListener("click", () => {
            const key = th.getAttribute("data-sort-key");
            sortTasksBy(key);
          });
          th.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              const key = th.getAttribute("data-sort-key");
              sortTasksBy(key);
            }
          });
        });

        // Local Storage Editor event listeners
        saveStorageBtn.addEventListener("click", saveStorageItem);
        deleteStorageBtn.addEventListener("click", deleteStorageItem);
        clearStorageBtn.addEventListener("click", clearAllLocalStorage);

        // Reset delete button if key input changes
        storageKeyInput.addEventListener("input", () => {
          if (editingStorageKey && storageKeyInput.value.trim() !== editingStorageKey) {
            deleteStorageBtn.disabled = true;
            editingStorageKey = null;
          }
        });

        // Initial render tasks if members view is active
        if (membersView.style.display !== "none") {
          renderTasks();
          updateSelectAllCheckbox();
        }
      }

      init();
    })();
  </script>
</body>
</html>
